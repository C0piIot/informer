{% extends 'base.html' %}
{% load i18n django_bootstrap5 %}

{% block body-content %}
{{ block.super }}
<div class="container">
	<h1>{% trans "Pipeline edit" %}</h1>
	<form class="card" action="{% url 'pipelines:edit' current_environment.slug pipeline.id %}" method="post">
		{% csrf_token %}
		<div class="card-body">
			{% bootstrap_form form %}
			<button class="btn btn-primary" type="submit">{% trans "Update" %}</button>	
		</div>
	</form>

	<div class="dropdown">
		<button class="btn btn-secondary dropdown-toggle" type="button" id="newStep" data-bs-toggle="dropdown" aria-expanded="false">
		{% translate "New step" %}
		</button>
  		<ul class="dropdown-menu" aria-labelledby="addStep">
		    {% for type, name in step_types %}
                <li>
                    <a class="dropdown-item" data-bs-toggle="modal" href="#modal-add-{{ type }}">
                        {{ name|title }}
                    </a>
                </li>
		    {% endfor %}
		</ul>
	</div>
</div>

{% for type, name in step_types %}
<div class="modal" id="modal-add-{{ type }}" tabindex="-1" aria-labelledby="modal-add-{{ type }}-title" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modal-add-{{ type }}-title">
            {% blocktranslate %}Add {{ type }} step{% endblocktranslate %}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="{% translate 'Close' %}"></button>
      </div>
      <div class="modal-body">
        {% include 'pipelines/steps/delay_form.html' %}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
{% endfor %}



{% endblock body-content %}