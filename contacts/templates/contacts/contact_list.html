{% extends 'list.html' %}
{% load i18n static %}

{% block title %}{% translate "Contacts" %} - {{ current_environment }} - {{ block.super }}{% endblock title %}

{% block breadcrumbds %}
{{ block.super }}
<li class="breadcrumb-item"><a href="{{ current_environment.get_absolute_url }}">{{ current_environment }}</a></li>
<li class="breadcrumb-item active" aria-current="page">{% translate "Contacts" %}</li>
{% endblock breadcrumbds %}

{% block list-actions %}
<a class="btn btn-secondary" href="{% url 'contacts:contact_create' current_environment.slug %}">{% translate "New contact" %}</a>
{% endblock list-actions %}

{% block colgroup %}<col class="col-2"><col class="col-4"><col class="col-4"><col class="col-2">{% endblock colgroup %}

{% block thead-tr %}
<th>{% translate "Key" %}</th>
<th>{% translate "Name" %}</th>
<th>{% translate "Channels" %}</th>
{% endblock thead-tr %}


{% block object-tr %}
<td>{{ object.key }}</td>
<td>
    <a href="#" title="{% translate 'View' %}" class="text-decoration-none">
        {{ object }}   
    </a>
</td>
<td>
{% for channel in channels %}
    {% if channel.pk|title in object.channel_data %}{{ channel }}{% endif %}
{% endfor %}
</td>
{% endblock object-tr %}

{% block object-actions %}
<a title="{% translate 'Edit' %}" class="btn btn-sm btn-outline-primary" href="{% url 'contacts:contact_update' current_environment.slug object.key %}">
    {% translate "Edit" %}
</a>
<button title="{% translate 'Remove' %}" class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#delete-{{ object.key }}" type="button">
    {% translate "Delete" %}
</button>
{% endblock object-actions %}

{% block empty-tr %}<td colspan="3" class="text-center fst-italic">{% translate "No contacts found" %}</td>{% endblock empty-tr %}

{% block body-content %}

{% with channels=current_environment.site.channels.all %}
{{ block.super }}
{% endwith %}
{% for contact in object_list %}
{% url 'contacts:contact_remove' current_environment.slug contact.key as delete_url %}
{% include 'modal_delete.html' with object=contact.instance modal_id='delete-'|add:contact.key %}
{% endfor %}
{% endblock body-content %}